{{ header }}
<div id="blog-category" class="container product-listing">  
  <div class="row">
    {{ column_left }}
	{% if column_left and column_right %}
		{% set class = 'col-sm-6 fluid-allsidebar' %}
	{% elseif column_left or column_right %}
		{% set class = 'col-lg-9 col-md-12 col-sm-12 fluid-sidebar' %}
	{% else %}
		{% set class = 'col-sm-12' %}
	{% endif %}
			
    <div id="content" class="{{ class }}">
		{{ content_top }}
		{% if column_left or column_right %}
		<a href="javascript:void(0)" class="btn btn-primary open-sidebar hidden-lg hidden-md form-group"><i class="fa fa-bars"></i> {{ text_sidebar }} </a>
		<div class="sidebar-overlay "></div>
		{% endif %}
		
		<div class="blog-category clearfix">
			<div class="blog-header">
				<h3>{{ heading_title }}</h3>				
				{% if image %}
					<img src="{{ image }}" alt="{{ heading_title }}" title="{{ heading_title }}" class="img-thumbnail"/>
				{% endif %}
				{% if description %}
					{{ description }}
				{% endif %}
			</div>
			
			<div class="blog-top hidden">
				<h3>{{ text_refine }}</h3>
				<div class="blog-top__search input-group dropdown mb-3">
					<input type="text" name="search" value="{{ search }}" placeholder="{{ entry_search }}" id="input-search" class="form-control"/>
					{% if topics %}
					  <select name="topic_id" id="input-topic" class="form-select" onchange="">
						<option value="">{{ text_all }}</option>
						{% for topic in topics %}
						  <option value="{{ topic.topic_id }}"{% if topic.topic_id == topic_id %} selected{% endif %}>{{ topic.name }}</option>
						{% endfor %}
					  </select>
					{% endif %}
					<button id="button-search" class="btn btn-primary">{{ button_search }}</button>
				</div>
				<div class="row mb-3 hidden">
					<div class="col-lg offset-lg-8">
					  <div class="input-group">
						<label for="input-sort" class="input-group-text">{{ text_sort }}</label> <select id="input-sort" class="form-select" onchange="location = this.value;">
						  {% for sorts in sorts %}
							<option value="{{ sorts.href }}"{% if sorts.value == '%s-%s'|format(sort, order) %} selected{% endif %}>{{ sorts.text }}</option>
						  {% endfor %}
						</select>
					  </div>
					</div>
				</div>
			</div>
			
			{#==== filters panel Top==== #}
			<div class="product-filter product-filter-top filters-panel hidden-sm hidden-xs">
				  <div class="row">
						<div class="col-sm-4 view-mode">
							<div class="list-view ">
								<button type="button" id="grid-view" class="btn btn-view hidden-sm hidden-xs">1</button>
								<button type="button" id="grid-view-2" class="btn btn-view ">2</button>
								<button type="button" id="grid-view-3" class="btn btn-view hidden-sm hidden-xs ">3</button>
								<button type="button" id="grid-view-4" class="btn btn-view hidden-sm hidden-xs">4</button>
								<button type="button" id="list-view" class="btn btn-view list "><i class="fa fa-bars"></i></button>								
							</div>
						</div>					
				  </div>
			</div>
			
			<div class="blog-listitem row">
			{% if articles %}
				{% for article in articles %}
					<div class="blog-item">
						<div class="blog-item-inner clearfix">
							{% if article.image %}
								<div class="itemBlogImg clearfix">
									<div class="article-image">
										<div>
											<a class="popup-gallery" href="{{ article.image }}"><img src="{{ article.image }}" alt="{{ article.name }}" /></a>
										</div>
										<div class="article-date hidden-sm hidden-xs">
											<div class="date">															 
												<span class="article-date">	
													{% set full_date 		= article.date_added|split('/') %}														
													{% set article_day   	= full_date[0]%}	
													{% set article_month 	= full_date[1]%}
													{% set article_year  	= full_date[2]%}
													<b>{{ article_day }}</b> {{ article_month }}
												</span>
											</div>
										</div>
									</div>
								</div>
							{% endif %}
							<div class="itemBlogContent clearfix">								
								<div class="blog-content">
									<div class="article-title font-title">
										<h4><a href="{{ article.href }}">{{ article.name }}</a></h4>
									</div>									
									<div class="blog-meta">
										<span class="author"><i class="fa fa-user"></i><span>{{ text_by }} </span><a href="{{ article.filter_author }}">{{ article.author }}</a></span>									
										<span class="comment_count"><i class="fa fa-comment-o"></i>{{ article.comment_total }} {{ text_comment }}</span>																			
									</div>									
									<p class="article-description hidden-sm hidden-xs">
										{{ article.description }}
									</p>
									<div class="readmore">
										<a class="btn-readmore font-title" href="{{ article.href }}"><i class="fa fa-caret-right"></i>{{ button_continue }}</a>
									</div>
								</div>
							</div>
						</div>
					</div>	
				{% endfor %}
				
				<div class="product-filter product-filter-bottom filters-panel clearfix">
					<div class="row">							
						<div class="col-md-12"><div>{{ pagination }}</div></div>
						<div class="col-sm-12 hidden">{{ results }}</div>
					</div>
				</div>
				
				<script type="text/javascript"><!--
					reinitView();
					function getParameterByName(name, url) {
					    if (!url) url = window.location.href;
					    name = name.replace(/[\[\]]/g, "\\$&");
					    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
					        results = regex.exec(url);
					    if (!results) return null;
					    if (!results[2]) return '';
					    return decodeURIComponent(results[2].replace(/\+/g, " "));
					}
					function reinitView() {
						
						$('.view-mode .list-view button').bind("click", function() {
							$(this).parent().find('button').removeClass('active');
							$(this).addClass('active');
						});	
						// Product List
						$('#list-view').click(function() {
							$('#content .blog-item').attr('class', 'blog-item blog-list col-xs-12 col-12');
							localStorage.setItem('blogview', 'blog-list');
						});

						// Product Grid
						$('#grid-view').click(function() {
							$('#content .blog-item').attr('class', 'blog-item blog-grid blog-grid-1 col-sm-12 col-xs-12 col-12');
							localStorage.setItem('blogview', 'blog-grid');
						});

						// Product Grid 2
						$('#grid-view-2').click(function() {
							$('#content .blog-item').attr('class', 'blog-item blog-grid blog-grid-2 col-lg-6 col-md-6 col-sm-6 col-xs-12 col-12');
							localStorage.setItem('blogview', 'blog-2');
						});

						// Product Grid 3
						$('#grid-view-3').click(function() {
							$('#content .blog-item').attr('class', 'blog-item blog-grid blog-grid-3 col-lg-4 col-md-4 col-sm-6 col-xs-12 col-12');
							localStorage.setItem('blogview', 'blog-3');
						});

						// Product Grid 4
						$('#grid-view-4').click(function() {
							$('#content .blog-item').attr('class', 'blog-item blog-list blog-grid-4 col-lg-3 col-md-4 col-sm-6 col-xs-12 col-12');
							localStorage.setItem('blogview', 'blog-4');
						});

						var url_blogview = getParameterByName('blogview'); // "lorem"
						if(localStorage.getItem('blogview')== null) localStorage.setItem('blogview', '{{simple_blog_columns}}');
						if(url_blogview){
							if (url_blogview == 'blog-grid') {
								$('#grid-view').trigger('click');
							}  else if (url_blogview == 'blog-2'){
								$('#grid-view-2').trigger('click');
							} else if (url_blogview == 'blog-3' ){
								$('#grid-view-3').trigger('click');
							} else if (url_blogview == 'blog-4'){
								$('#grid-view-4').trigger('click');
							} else{
								$('#list-view').trigger('click');
							}
							
						}else{

							if (localStorage.getItem('blogview') == 'blog-grid') {
								$('#grid-view').trigger('click');
							}  else if (localStorage.getItem('blogview') == 'blog-2'){
								$('#grid-view-2').trigger('click');
							} else if (localStorage.getItem('blogview') == 'blog-3' ){
								$('#grid-view-3').trigger('click');
							} else if (localStorage.getItem('blogview') == 'blog-4'){
								$('#grid-view-4').trigger('click');
							} else{
								$('#list-view').trigger('click');
							}
						}
						
					}

					//--></script> 
				
			{% else %}
				<p class="text-center">{{ text_no_results }}</p>
			{% endif %}
			</div>
		</div>
		{{ content_bottom }}
    </div>
    {{ column_right }}
  </div>
</div>
<script type="text/javascript"><!--
$('#button-search').bind('click', function() {
    url = 'index.php?route=cms/blog&language={{ language }}';

    var search = $('#input-search').val();

    if (search) {
        url += '&search=' + encodeURIComponent(search);
    }

    var topic_id = $('#input-topic').prop('value');

    if (topic_id > 0) {
        url += '&topic_id=' + topic_id;
    }

    location = url;
});

$('#input-search').bind('keydown', function(e) {
    if (e.keyCode == 13) {
        $('#button-search').trigger('click');
    }
});
//--></script>
{{ footer }}
